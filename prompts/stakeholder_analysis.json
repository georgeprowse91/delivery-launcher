{
  "prompt_id": "P1.2",
  "prompt_name": "Stakeholder Analysis",
  "artifact": "Stakeholder Analysis Workbook",
  "instruction": "ENGAGEMENT CONTEXT — populate all fields before running this prompt. These values override anything inferred from prior steps.\n\nClient Name: [CLIENT_NAME]\nEngagement Name: [ENGAGEMENT_NAME]\nEngagement Code: [ENGAGEMENT_CODE]\nEngagement Manager: [ENGAGEMENT_MANAGER]\nPartner in Charge: [PARTNER]\nIndustry Sector: [INDUSTRY]\nService Line / Capability: [SERVICE_LINE]\nDelivery Methodology: [WATERFALL / AGILE / HYBRID]\nFee Structure: [FIXED_PRICE / TIME_AND_MATERIALS / CAPPED_T&M]\nEngagement Start Date: [START_DATE]\nEngagement End Date: [END_DATE]\nTotal Budget / Fee: [BUDGET]\nPrimary Workstreams: [WORKSTREAM_1], [WORKSTREAM_2], [WORKSTREAM_3]\nKey Client Stakeholders: [NAME (ROLE)], [NAME (ROLE)], [NAME (ROLE)]\nEngagement Complexity: [LOW / MEDIUM / HIGH]\nRegulatory / Compliance Requirements: [FREE TEXT OR NONE]\n\n---\n\nYou are a PwC engagement planning assistant with access to code interpreter.\n\nRefer to the Engagement Intake Summary from Step P1.1 above.\n\nBefore building the Stakeholder Analysis workbook, you must first work through a structured stakeholder identification process with the user. Follow the steps below in sequence.\n\n---\n\nCONTEXT CHECK\n\nBefore presenting any clarification questions to the user, count how many of the 16 Engagement Context fields above are populated (i.e. not blank and not still containing a placeholder such as [CLIENT_NAME]).\n\nIf fewer than 8 of the 16 fields are completed, stop and output the message below — do not proceed to Step 1 until the user confirms the fields have been filled:\n\n\"⚠️ Insufficient engagement context detected. Only [N] of 16 required context fields are populated. To generate a meaningful Stakeholder Analysis Workbook rather than a generic template, please fill in at minimum: Client Name, Engagement Name, Delivery Methodology, Fee Structure, Engagement Start Date, Total Budget, and Primary Workstreams. Update the context block above and re-run.\"\n\nIf 8 or more fields are populated, proceed to Step 1 below.\n\n---\n\nSTEP 1 — STAKEHOLDER IDENTIFICATION\n\nParse the Engagement Intake Summary and identify all stakeholder roles and groups that would typically be expected for an engagement of this type, industry, complexity and scope.\n\nPresent the user with a structured stakeholder identification table formatted as follows:\n\n| # | Stakeholder Role | Organisation | Stakeholder Type | Engagement Role | Influence | Interest | Why Expected |\n|---|---|---|---|---|---|---|---|\n\nPopulate the table with your recommended stakeholders based on:\n- The client industry, sector and sub-sector\n- The engagement objectives and scope\n- The service offerings and building blocks selected\n- The technology and alliance partners involved\n- The regulatory profile and risk profile\n- Standard PwC engagement governance expectations\n\nInclude stakeholders across the following categories as relevant:\n- Client executive sponsors and decision makers\n- Client project owners and programme managers\n- Client subject matter experts by workstream\n- Client IT and technology leads\n- Client finance and procurement leads\n- Client legal, risk and compliance leads\n- Client HR and change management leads\n- Client end users and business representatives\n- PwC engagement lead and engagement manager\n- PwC workstream leads by domain\n- PwC subject matter experts\n- Alliance partner representatives if applicable\n- Regulators or external bodies if applicable\n- Third party vendors or system integrators if applicable\n\nAfter presenting the table ask the user the following:\n\n'Above is a list of stakeholder roles I would expect for this engagement based on the Engagement Intake Summary. Please review and for each row either:\n\n1. Confirm the name and any details you know (e.g. Jane Smith — CFO)\n2. Add any additional stakeholders I have missed\n3. Remove any roles that are not applicable to this engagement\n4. Type PROCEED if you would like me to continue with the roles as listed without named individuals\n\nYou do not need to provide all details — any information you can share will improve the quality of the register. Where names are unknown I will populate the register with the role title as a placeholder.'\n\n---\n\nSTEP 2 — CONFIRM AND PROCEED\n\nWait for the user response before proceeding.\n\nOnce the user has responded:\n- Incorporate any confirmed names, roles or additional stakeholders provided\n- Remove any roles the user has flagged as not applicable\n- For any roles where no name was provided use the role title as the Full Name placeholder\n- Add a note in the Notes column: 'Stakeholder identity not confirmed — placeholder role only. Confirm with engagement sponsor before distributing.'\n\nThen proceed to build the workbook as specified below.\n\n---\n\nSTEP 3 — BUILD THE WORKBOOK\n\nGenerate a comprehensive Stakeholder Analysis workbook as a formatted Excel file using openpyxl applying PwC formatting standards. Make the file available for download as .xlsx.\n\n---\n\nWORKBOOK RATIONALISATION — generate a maximum of 4 sheets:\n1. Stakeholder Register — full register with all columns (Name, Role, Organisation, Influence, Interest, Engagement Strategy, Owner, Notes).\n2. Engagement Plan — planned engagement activities per stakeholder (Stakeholder | Activity | Frequency | Next Date | Owner | Status).\n3. Stakeholder Heat Map — 2×2 influence/interest matrix populated from the register (use conditional formatting to colour-code quadrants).\n4. Change Log.\nDo not generate separate archive or communication preference sheets — fold preferences into the Stakeholder Register as columns.\n\nPWC FORMATTING STANDARDS FOR EXCEL\n\nFonts\n- Headings and column headers: Arial, 10pt, bold\n- Body text: Arial, 10pt\n- Small labels and notes: Arial, 9pt\n\nColour Palette\n- Primary header background: #D04A02, text white, bold\n- Secondary header background: #F5F5F5, text #2D2D2D, bold\n- Alternating row shading: white #FFFFFF and light grey #F9F9F9\n- Borders: #DDDDDD, thin\n- Positive sentiment: #E8F5E9, text #2E7D32\n- Neutral sentiment: #FFF8E1, text #F57F17\n- Negative sentiment: #FFEBEE, text #C62828\n- High risk: #FFEBEE, text #C62828\n- Medium risk: #FFF3E0, text #E65100\n- Low risk: #E8F5E9, text #2E7D32\n- Placeholder rows (no confirmed name): text #AAAAAA, italic\n\nWorkbook Structure\n- Tab colour for register and analysis tabs: #D04A02\n- Tab colour for reference and log tabs: #F5F5F5\n- Freeze top two rows on all tabs\n- Auto-filter on all data columns\n- Column widths set to content\n- Print area set, print titles set to header rows\n- Footer on every sheet: 'PwC Private and Confidential — prepared for [Client Name] only' left, page number right\n\n---\n\nWORKBOOK STRUCTURE\n\nThe workbook must contain the following sheets:\n\n**Sheet 1: Stakeholder Register**\n\nSummary bar above the register (rows 1-2) showing:\n- Total Stakeholders: =COUNTA(B4:B1000)\n- Client Stakeholders: =COUNTIF(E4:E1000,\"Client\")\n- PwC Stakeholders: =COUNTIF(E4:E1000,\"PwC\")\n- High Priority: =COUNTIFS(N4:N1000,\"Critical\")+COUNTIFS(N4:N1000,\"High\")\n- Sign-off Required: =COUNTIF(S4:S1000,\"Yes\")\n- Not Yet Onboarded: =COUNTIFS(T4:T1000,\"<>Yes\")\n- Unconfirmed Stakeholders: =COUNTIF(W4:W1000,\"Placeholder\")\n\nColumns:\n- Stakeholder ID (format STK-001, =\"STK-\"&TEXT(ROW()-3,\"000\"))\n- Full Name\n- Title / Role\n- Organisation\n- Stakeholder Type (dropdown: Client, PwC, Regulator, Vendor, Alliance Partner, Other)\n- Engagement Role (dropdown: Sponsor, Decision Maker, Project Owner, SME, End User, Approver, Informed Only, Other)\n- Internal or External (dropdown: Internal, External)\n- Department or Business Unit\n- Location\n- Email Address\n- Phone Number\n- Influence Level (dropdown: High, Medium, Low)\n- Interest Level (dropdown: High, Medium, Low)\n- Engagement Priority (formula: auto-calculated from Influence and Interest)\n- Engagement Strategy (dropdown: Manage Closely, Keep Satisfied, Keep Informed, Monitor)\n- Preferred Communication Channel (dropdown: Email, Meeting, Workshop, Report, Steering Committee, Ad Hoc)\n- Communication Frequency (dropdown: Daily, Weekly, Fortnightly, Monthly, Milestone-based, As Required)\n- Sign-off Required (dropdown: Yes, No)\n- Sign-off Deliverables\n- Onboarded to Engagement (dropdown: Yes, No, Pending)\n- Confirmed or Placeholder (dropdown: Confirmed, Placeholder)\n- Notes\n- Last Updated (date)\n- Updated By\n\nEngagement Priority formula:\n=IF(AND(L4=\"High\",M4=\"High\"),\"Critical\",IF(OR(AND(L4=\"High\",M4=\"Medium\"),AND(L4=\"Medium\",M4=\"High\")),\"High\",IF(OR(AND(L4=\"Medium\",M4=\"Medium\"),AND(L4=\"Low\",M4=\"High\"),AND(L4=\"High\",M4=\"Low\")),\"Medium\",\"Low\")))\n\nConditional formatting on Engagement Priority:\n- Critical: #FFEBEE, text #C62828, bold\n- High: #FFF3E0, text #E65100\n- Medium: #FFF8E1, text #F57F17\n- Low: #E8F5E9, text #2E7D32\n\nConditional formatting on rows:\n- If Sign-off Required = Yes: row background #FFF8E1\n- If Influence = High AND Interest = High: row background #FFF4F0\n- If Confirmed or Placeholder = Placeholder: text #AAAAAA, italic\n- If Onboarded = No: text #AAAAAA\n\n**Sheet 2: Stakeholder Analysis**\n\nSummary bar above the analysis (rows 1-2) showing:\n- Total Stakeholders\n- High Engagement Risk: =COUNTIF(L4:L1000,\"High\")\n- Requiring Immediate Action: =COUNTIF(S4:S1000,\"YES — Immediate Action Required\")\n- Unknown Sentiment: =COUNTIF(J4:J1000,\"Unknown\")\n- Declining Sentiment: linked from Sheet 3\n- At Risk or Escalated: =COUNTIFS(V4:V1000,\"At Risk\")+COUNTIFS(V4:V1000,\"Escalated\")\n\nColumns:\n- Stakeholder ID (reference from Sheet 1)\n- Full Name\n- Title / Role\n- Stakeholder Type\n- Engagement Role\n- Influence Level\n- Interest Level\n- Engagement Priority\n- Current Sentiment (dropdown: Champion, Supporter, Neutral, Sceptic, Blocker, Unknown)\n- Sentiment Confidence (dropdown: High, Medium, Low)\n- Engagement Risk Level (formula)\n- Engagement Risk Description\n- Key Concerns and Interests\n- Potential Objections\n- Motivators\n- Recommended Actions\n- Owner\n- Target Sentiment (dropdown: Champion, Supporter, Neutral)\n- Sentiment Gap (formula)\n- Priority Actions Required (formula)\n- Action Due Date\n- Status (dropdown: On Track, At Risk, Needs Attention, Escalated)\n- Last Reviewed (date)\n- Notes\n\nEngagement Risk Level formula:\n=IF(AND(F4=\"High\",OR(I4=\"Blocker\",I4=\"Sceptic\",I4=\"Unknown\")),\"High\",IF(AND(F4=\"Medium\",OR(I4=\"Blocker\",I4=\"Sceptic\")),\"Medium\",IF(AND(F4=\"Low\",I4=\"Blocker\"),\"Medium\",\"Low\")))\n\nSentiment Gap formula (using SentimentScores named range):\n=IFERROR(VLOOKUP(R4,SentimentScores,2,0)-VLOOKUP(I4,SentimentScores,2,0),\"\")\n\nPriority Actions Required formula:\n=IF(AND(S4>=2,F4=\"High\"),\"YES — Immediate Action Required\",IF(OR(AND(S4>=1,F4=\"High\"),S4>=2),\"Yes — Action Required\",\"\"))\n\nConditional formatting:\n- Engagement Risk High: #FFEBEE, text #C62828, bold\n- Engagement Risk Medium: #FFF3E0, text #E65100\n- Engagement Risk Low: #E8F5E9, text #2E7D32\n- Sentiment Gap >= 2: #FFEBEE, text #C62828\n- Sentiment Gap = 1: #FFF8E1, text #F57F17\n- Sentiment Gap <= 0: #E8F5E9, text #2E7D32\n- Priority Actions — Immediate: #FFEBEE, text #C62828, bold\n- Priority Actions — Required: #FFF8E1, text #F57F17\n\n**Sheet 3: Sentiment Tracker**\n\nColumns:\n- Stakeholder ID\n- Full Name\n- Baseline Sentiment\n- Review 1 Sentiment\n- Review 2 Sentiment\n- Review 3 Sentiment\n- Sentiment Trend (formula)\n- Notes\n\nSentiment Trend formula:\n=IF(AND(D4=\"\",E4=\"\",F4=\"\",G4=\"\"),\"Not Yet Reviewed\",IF(IFERROR(VLOOKUP(IF(G4<>\"\",G4,IF(F4<>\"\",F4,IF(E4<>\"\",E4,D4))),SentimentScores,2,0),0)>IFERROR(VLOOKUP(D4,SentimentScores,2,0),0),\"Improving\",IF(IFERROR(VLOOKUP(IF(G4<>\"\",G4,IF(F4<>\"\",F4,IF(E4<>\"\",E4,D4))),SentimentScores,2,0),0)=IFERROR(VLOOKUP(D4,SentimentScores,2,0),0),\"Stable\",\"Declining\")))\n\nConditional formatting:\n- Improving: #E8F5E9, text #2E7D32\n- Stable: #FFF8E1, text #F57F17\n- Declining: #FFEBEE, text #C62828\n- Not Yet Reviewed: #F5F5F5, text #AAAAAA\n\n**Sheet 4: Engagement Action Plan**\n\nSummary bar (rows 1-2):\n- Total Actions: =COUNTA(B4:B1000)\n- Critical Actions: =COUNTIF(F4:F1000,\"Critical\")\n- Overdue Actions: =COUNTIFS(G4:G1000,\"<\"&TODAY(),H4:H1000,\"<>Complete\")\n- Complete Actions: =COUNTIF(H4:H1000,\"Complete\")\n- Completion Rate: =IFERROR(COUNTIF(H4:H1000,\"Complete\")/COUNTA(B4:B1000),0) — format as percentage\n\nColumns:\n- Action ID (=\"ACT-\"&TEXT(ROW()-3,\"000\"))\n- Stakeholder ID\n- Full Name\n- Recommended Action\n- Action Type (dropdown: Meeting, Workshop, Communication, Escalation, Briefing, Relationship Building, Issue Resolution, Other)\n- Priority (dropdown: Critical, High, Medium, Low)\n- Due Date\n- Status (dropdown: Not Started, In Progress, Complete, Deferred, Cancelled)\n- Owner\n- Outcome\n- Notes\n\nConditional formatting:\n- Priority Critical: #FFEBEE, text #C62828, bold\n- Priority High: #FFF3E0, text #E65100\n- Status Complete: #E8F5E9, text #2E7D32\n- Overdue (Due Date < today and Status not Complete): #FFEBEE, text #C62828\n\n**Sheet 5: Influence-Interest Matrix**\n\nA colour-coded 3x3 reference grid showing the influence-interest quadrants with stakeholder names listed in each cell pulled from Sheet 1.\n\nQuadrant colour coding:\n- Manage Closely (High/High): #FFF4F0, border #D04A02\n- Keep Satisfied (High/Low): #FFF8E1, border #F57F17\n- Keep Informed (Low/High): #EFF6FF, border #3B82F6\n- Monitor (Low/Low): #F5F5F5, border #AAAAAA\n\n**Sheet 6: Reference — Definitions**\n\nA read-only reference sheet containing:\n\nSentiment definitions table:\n- Champion: Actively advocates for the engagement. Will promote it to others and help overcome resistance.\n- Supporter: Positive about the engagement. Will cooperate fully and provide assistance when asked.\n- Neutral: Neither positive nor negative. Will comply but will not go out of their way to help or hinder.\n- Sceptic: Doubtful about the engagement value or approach. May raise concerns or slow progress.\n- Blocker: Actively opposed. May attempt to undermine, delay or derail the engagement.\n- Unknown: Sentiment has not yet been assessed. Treat as at-risk until confirmed.\n\nEngagement strategy definitions table:\n- Manage Closely: High influence, high interest. Involve deeply in decisions and keep fully informed at all times.\n- Keep Satisfied: High influence, lower interest. Keep informed on key decisions. Do not overwhelm with detail.\n- Keep Informed: Lower influence, high interest. Provide regular updates. Involve in relevant activities.\n- Monitor: Lower influence, lower interest. Monitor for changes. Provide standard communications only.\n\n**Sheet 7: Hidden — Sentiment Scores**\n\nA hidden two-column lookup table used by formulas:\n- Champion: 5\n- Supporter: 4\n- Neutral: 3\n- Sceptic: 2\n- Blocker: 1\n- Unknown: 0\n\nDefine this range as the named range SentimentScores.\nHide this sheet.\n\n**Sheet 8: Change Log**\n\nColumns:\n- Change ID (=\"CHG-\"&TEXT(ROW()-3,\"000\"))\n- Date\n- Stakeholder ID\n- Sheet Changed\n- Field Changed\n- Previous Value\n- New Value\n- Changed By\n- Reason for Change\n\n---\n\nDATA POPULATION\n\nPopulate Sheet 1 with all confirmed and placeholder stakeholders from Step 2.\n\nFor each stakeholder on Sheet 2:\n- Set Current Sentiment to Unknown unless context from the intake summary supports a reasonable inference\n- Set Sentiment Confidence to Low for all pre-populated rows\n- Infer Key Concerns and Interests from role, stakeholder type and engagement context\n- Infer Potential Objections from role and engagement objectives\n- Infer Motivators from role and engagement objectives\n- Suggest Recommended Actions based on influence, interest, sentiment and engagement strategy\n- Set Target Sentiment to Supporter as default unless Champion is clearly appropriate\n- Set Status to Needs Attention for any stakeholder where Engagement Risk Level is High\n- Add a note explaining the basis for each inference\n\nPopulate Sheet 4 with at least one recommended action per Critical or High priority stakeholder.\n\nSet Baseline Sentiment on Sheet 3 to match Current Sentiment from Sheet 2 for all pre-populated rows.\n\n---\n\nWhere a field cannot be determined leave the cell blank and add a comment: 'To be confirmed.'\n\nEnsure all dropdown validations are applied and functional.\n\nEnsure all formulas are applied to all data rows and will extend correctly when new rows are added.\n\nEnsure the SentimentScores named range is defined correctly and all formula references to it are valid.\n\nOnce the Excel file is generated and available for download confirm you are ready to proceed to Step P1.3 Scope Statement."
}